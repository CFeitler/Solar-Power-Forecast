#undef USE_TESTDATA

using System;
using System.Collections.Generic;
using System.Data;
using System.Net.Http;
using System.Net.Http.Headers;
using System.Text.Json.Serialization;
using System.Threading.Tasks;
using System.Xml;
using CopaData.Drivers.Contracts;
using Newtonsoft.Json;


namespace SolCast
{

  public class SolCast : ISolarPowerForeCast
  {
    private ILogger _logger;
    private string testData = "{\"forecasts\":[{\"pv_estimate\":3.1017,\"pv_estimate10\":2.5709,\"pv_estimate90\":6.0261,\"period_end\":\"2022-01-04T14:30:00.0000000Z\",\"period\":\"PT30M\"},{\"pv_estimate\":1.6793,\"pv_estimate10\":0.5929,\"pv_estimate90\":5.4156,\"period_end\":\"2022-01-04T15:00:00.0000000Z\",\"period\":\"PT30M\"},{\"pv_estimate\":0.5057,\"pv_estimate10\":0.1037,\"pv_estimate90\":0.6539,\"period_end\":\"2022-01-04T15:30:00.0000000Z\",\"period\":\"PT30M\"},{\"pv_estimate\":0,\"pv_estimate10\":0,\"pv_estimate90\":0,\"period_end\":\"2022-01-04T16:00:00.0000000Z\",\"period\":\"PT30M\"},{\"pv_estimate\":0,\"pv_estimate10\":0,\"pv_estimate90\":0,\"period_end\":\"2022-01-04T16:30:00.0000000Z\",\"period\":\"PT30M\"},{\"pv_estimate\":0,\"pv_estimate10\":0,\"pv_estimate90\":0,\"period_end\":\"2022-01-04T17:00:00.0000000Z\",\"period\":\"PT30M\"},{\"pv_estimate\":0,\"pv_estimate10\":0,\"pv_estimate90\":0,\"period_end\":\"2022-01-04T17:30:00.0000000Z\",\"period\":\"PT30M\"},{\"pv_estimate\":0,\"pv_estimate10\":0,\"pv_estimate90\":0,\"period_end\":\"2022-01-04T18:00:00.0000000Z\",\"period\":\"PT30M\"},{\"pv_estimate\":0,\"pv_estimate10\":0,\"pv_estimate90\":0,\"period_end\":\"2022-01-04T18:30:00.0000000Z\",\"period\":\"PT30M\"},{\"pv_estimate\":0,\"pv_estimate10\":0,\"pv_estimate90\":0,\"period_end\":\"2022-01-04T19:00:00.0000000Z\",\"period\":\"PT30M\"},{\"pv_estimate\":0,\"pv_estimate10\":0,\"pv_estimate90\":0,\"period_end\":\"2022-01-04T19:30:00.0000000Z\",\"period\":\"PT30M\"},{\"pv_estimate\":0,\"pv_estimate10\":0,\"pv_estimate90\":0,\"period_end\":\"2022-01-04T20:00:00.0000000Z\",\"period\":\"PT30M\"},{\"pv_estimate\":0,\"pv_estimate10\":0,\"pv_estimate90\":0,\"period_end\":\"2022-01-04T20:30:00.0000000Z\",\"period\":\"PT30M\"},{\"pv_estimate\":0,\"pv_estimate10\":0,\"pv_estimate90\":0,\"period_end\":\"2022-01-04T21:00:00.0000000Z\",\"period\":\"PT30M\"},{\"pv_estimate\":0,\"pv_estimate10\":0,\"pv_estimate90\":0,\"period_end\":\"2022-01-04T21:30:00.0000000Z\",\"period\":\"PT30M\"},{\"pv_estimate\":0,\"pv_estimate10\":0,\"pv_estimate90\":0,\"period_end\":\"2022-01-04T22:00:00.0000000Z\",\"period\":\"PT30M\"},{\"pv_estimate\":0,\"pv_estimate10\":0,\"pv_estimate90\":0,\"period_end\":\"2022-01-04T22:30:00.0000000Z\",\"period\":\"PT30M\"},{\"pv_estimate\":0,\"pv_estimate10\":0,\"pv_estimate90\":0,\"period_end\":\"2022-01-04T23:00:00.0000000Z\",\"period\":\"PT30M\"},{\"pv_estimate\":0,\"pv_estimate10\":0,\"pv_estimate90\":0,\"period_end\":\"2022-01-04T23:30:00.0000000Z\",\"period\":\"PT30M\"},{\"pv_estimate\":0,\"pv_estimate10\":0,\"pv_estimate90\":0,\"period_end\":\"2022-01-05T00:00:00.0000000Z\",\"period\":\"PT30M\"},{\"pv_estimate\":0,\"pv_estimate10\":0,\"pv_estimate90\":0,\"period_end\":\"2022-01-05T00:30:00.0000000Z\",\"period\":\"PT30M\"},{\"pv_estimate\":0,\"pv_estimate10\":0,\"pv_estimate90\":0,\"period_end\":\"2022-01-05T01:00:00.0000000Z\",\"period\":\"PT30M\"},{\"pv_estimate\":0,\"pv_estimate10\":0,\"pv_estimate90\":0,\"period_end\":\"2022-01-05T01:30:00.0000000Z\",\"period\":\"PT30M\"},{\"pv_estimate\":0,\"pv_estimate10\":0,\"pv_estimate90\":0,\"period_end\":\"2022-01-05T02:00:00.0000000Z\",\"period\":\"PT30M\"},{\"pv_estimate\":0,\"pv_estimate10\":0,\"pv_estimate90\":0,\"period_end\":\"2022-01-05T02:30:00.0000000Z\",\"period\":\"PT30M\"},{\"pv_estimate\":0,\"pv_estimate10\":0,\"pv_estimate90\":0,\"period_end\":\"2022-01-05T03:00:00.0000000Z\",\"period\":\"PT30M\"},{\"pv_estimate\":0,\"pv_estimate10\":0,\"pv_estimate90\":0,\"period_end\":\"2022-01-05T03:30:00.0000000Z\",\"period\":\"PT30M\"},{\"pv_estimate\":0,\"pv_estimate10\":0,\"pv_estimate90\":0,\"period_end\":\"2022-01-05T04:00:00.0000000Z\",\"period\":\"PT30M\"},{\"pv_estimate\":0,\"pv_estimate10\":0,\"pv_estimate90\":0,\"period_end\":\"2022-01-05T04:30:00.0000000Z\",\"period\":\"PT30M\"},{\"pv_estimate\":0,\"pv_estimate10\":0,\"pv_estimate90\":0,\"period_end\":\"2022-01-05T05:00:00.0000000Z\",\"period\":\"PT30M\"},{\"pv_estimate\":0,\"pv_estimate10\":0,\"pv_estimate90\":0,\"period_end\":\"2022-01-05T05:30:00.0000000Z\",\"period\":\"PT30M\"},{\"pv_estimate\":0,\"pv_estimate10\":0,\"pv_estimate90\":0,\"period_end\":\"2022-01-05T06:00:00.0000000Z\",\"period\":\"PT30M\"},{\"pv_estimate\":0,\"pv_estimate10\":0,\"pv_estimate90\":0,\"period_end\":\"2022-01-05T06:30:00.0000000Z\",\"period\":\"PT30M\"},{\"pv_estimate\":0,\"pv_estimate10\":0,\"pv_estimate90\":0,\"period_end\":\"2022-01-05T07:00:00.0000000Z\",\"period\":\"PT30M\"},{\"pv_estimate\":0.0631,\"pv_estimate10\":0.0316,\"pv_estimate90\":0.0789,\"period_end\":\"2022-01-05T07:30:00.0000000Z\",\"period\":\"PT30M\"},{\"pv_estimate\":0.2562,\"pv_estimate10\":0.1761,\"pv_estimate90\":0.3502,\"period_end\":\"2022-01-05T08:00:00.0000000Z\",\"period\":\"PT30M\"},{\"pv_estimate\":0.5197,\"pv_estimate10\":0.341,\"pv_estimate90\":0.6956,\"period_end\":\"2022-01-05T08:30:00.0000000Z\",\"period\":\"PT30M\"},{\"pv_estimate\":0.7723,\"pv_estimate10\":0.4941,\"pv_estimate90\":1.3512,\"period_end\":\"2022-01-05T09:00:00.0000000Z\",\"period\":\"PT30M\"},{\"pv_estimate\":1.2493,\"pv_estimate10\":0.6263,\"pv_estimate90\":2.0223,\"period_end\":\"2022-01-05T09:30:00.0000000Z\",\"period\":\"PT30M\"},{\"pv_estimate\":0.8722,\"pv_estimate10\":0.4068,\"pv_estimate90\":1.5581,\"period_end\":\"2022-01-05T10:00:00.0000000Z\",\"period\":\"PT30M\"},{\"pv_estimate\":1.0835,\"pv_estimate10\":0.4419,\"pv_estimate90\":1.9431,\"period_end\":\"2022-01-05T10:30:00.0000000Z\",\"period\":\"PT30M\"},{\"pv_estimate\":1.3267,\"pv_estimate10\":0.5044,\"pv_estimate90\":2.3721,\"period_end\":\"2022-01-05T11:00:00.0000000Z\",\"period\":\"PT30M\"},{\"pv_estimate\":1.4341,\"pv_estimate10\":0.5115,\"pv_estimate90\":2.6782,\"period_end\":\"2022-01-05T11:30:00.0000000Z\",\"period\":\"PT30M\"},{\"pv_estimate\":1.4462,\"pv_estimate10\":0.4817,\"pv_estimate90\":2.7613,\"period_end\":\"2022-01-05T12:00:00.0000000Z\",\"period\":\"PT30M\"},{\"pv_estimate\":1.4076,\"pv_estimate10\":0.4563,\"pv_estimate90\":2.9048,\"period_end\":\"2022-01-05T12:30:00.0000000Z\",\"period\":\"PT30M\"},{\"pv_estimate\":1.3852,\"pv_estimate10\":0.4319,\"pv_estimate90\":2.8201,\"period_end\":\"2022-01-05T13:00:00.0000000Z\",\"period\":\"PT30M\"},{\"pv_estimate\":1.0441,\"pv_estimate10\":0.3488,\"pv_estimate90\":2.5912,\"period_end\":\"2022-01-05T13:30:00.0000000Z\",\"period\":\"PT30M\"},{\"pv_estimate\":0.3239,\"pv_estimate10\":0.1144,\"pv_estimate90\":0.936,\"period_end\":\"2022-01-05T14:00:00.0000000Z\",\"period\":\"PT30M\"},{\"pv_estimate\":0.2275,\"pv_estimate10\":0.0696,\"pv_estimate90\":0.5924,\"period_end\":\"2022-01-05T14:30:00.0000000Z\",\"period\":\"PT30M\"},{\"pv_estimate\":0.113,\"pv_estimate10\":0.0282,\"pv_estimate90\":0.2784,\"period_end\":\"2022-01-05T15:00:00.0000000Z\",\"period\":\"PT30M\"},{\"pv_estimate\":0.0141,\"pv_estimate10\":0.0071,\"pv_estimate90\":0.0353,\"period_end\":\"2022-01-05T15:30:00.0000000Z\",\"period\":\"PT30M\"},{\"pv_estimate\":0,\"pv_estimate10\":0,\"pv_estimate90\":0,\"period_end\":\"2022-01-05T16:00:00.0000000Z\",\"period\":\"PT30M\"},{\"pv_estimate\":0,\"pv_estimate10\":0,\"pv_estimate90\":0,\"period_end\":\"2022-01-05T16:30:00.0000000Z\",\"period\":\"PT30M\"},{\"pv_estimate\":0,\"pv_estimate10\":0,\"pv_estimate90\":0,\"period_end\":\"2022-01-05T17:00:00.0000000Z\",\"period\":\"PT30M\"},{\"pv_estimate\":0,\"pv_estimate10\":0,\"pv_estimate90\":0,\"period_end\":\"2022-01-05T17:30:00.0000000Z\",\"period\":\"PT30M\"},{\"pv_estimate\":0,\"pv_estimate10\":0,\"pv_estimate90\":0,\"period_end\":\"2022-01-05T18:00:00.0000000Z\",\"period\":\"PT30M\"},{\"pv_estimate\":0,\"pv_estimate10\":0,\"pv_estimate90\":0,\"period_end\":\"2022-01-05T18:30:00.0000000Z\",\"period\":\"PT30M\"},{\"pv_estimate\":0,\"pv_estimate10\":0,\"pv_estimate90\":0,\"period_end\":\"2022-01-05T19:00:00.0000000Z\",\"period\":\"PT30M\"},{\"pv_estimate\":0,\"pv_estimate10\":0,\"pv_estimate90\":0,\"period_end\":\"2022-01-05T19:30:00.0000000Z\",\"period\":\"PT30M\"},{\"pv_estimate\":0,\"pv_estimate10\":0,\"pv_estimate90\":0,\"period_end\":\"2022-01-05T20:00:00.0000000Z\",\"period\":\"PT30M\"},{\"pv_estimate\":0,\"pv_estimate10\":0,\"pv_estimate90\":0,\"period_end\":\"2022-01-05T20:30:00.0000000Z\",\"period\":\"PT30M\"},{\"pv_estimate\":0,\"pv_estimate10\":0,\"pv_estimate90\":0,\"period_end\":\"2022-01-05T21:00:00.0000000Z\",\"period\":\"PT30M\"},{\"pv_estimate\":0,\"pv_estimate10\":0,\"pv_estimate90\":0,\"period_end\":\"2022-01-05T21:30:00.0000000Z\",\"period\":\"PT30M\"},{\"pv_estimate\":0,\"pv_estimate10\":0,\"pv_estimate90\":0,\"period_end\":\"2022-01-05T22:00:00.0000000Z\",\"period\":\"PT30M\"},{\"pv_estimate\":0,\"pv_estimate10\":0,\"pv_estimate90\":0,\"period_end\":\"2022-01-05T22:30:00.0000000Z\",\"period\":\"PT30M\"},{\"pv_estimate\":0,\"pv_estimate10\":0,\"pv_estimate90\":0,\"period_end\":\"2022-01-05T23:00:00.0000000Z\",\"period\":\"PT30M\"},{\"pv_estimate\":0,\"pv_estimate10\":0,\"pv_estimate90\":0,\"period_end\":\"2022-01-05T23:30:00.0000000Z\",\"period\":\"PT30M\"},{\"pv_estimate\":0,\"pv_estimate10\":0,\"pv_estimate90\":0,\"period_end\":\"2022-01-06T00:00:00.0000000Z\",\"period\":\"PT30M\"},{\"pv_estimate\":0,\"pv_estimate10\":0,\"pv_estimate90\":0,\"period_end\":\"2022-01-06T00:30:00.0000000Z\",\"period\":\"PT30M\"},{\"pv_estimate\":0,\"pv_estimate10\":0,\"pv_estimate90\":0,\"period_end\":\"2022-01-06T01:00:00.0000000Z\",\"period\":\"PT30M\"},{\"pv_estimate\":0,\"pv_estimate10\":0,\"pv_estimate90\":0,\"period_end\":\"2022-01-06T01:30:00.0000000Z\",\"period\":\"PT30M\"},{\"pv_estimate\":0,\"pv_estimate10\":0,\"pv_estimate90\":0,\"period_end\":\"2022-01-06T02:00:00.0000000Z\",\"period\":\"PT30M\"},{\"pv_estimate\":0,\"pv_estimate10\":0,\"pv_estimate90\":0,\"period_end\":\"2022-01-06T02:30:00.0000000Z\",\"period\":\"PT30M\"},{\"pv_estimate\":0,\"pv_estimate10\":0,\"pv_estimate90\":0,\"period_end\":\"2022-01-06T03:00:00.0000000Z\",\"period\":\"PT30M\"},{\"pv_estimate\":0,\"pv_estimate10\":0,\"pv_estimate90\":0,\"period_end\":\"2022-01-06T03:30:00.0000000Z\",\"period\":\"PT30M\"},{\"pv_estimate\":0,\"pv_estimate10\":0,\"pv_estimate90\":0,\"period_end\":\"2022-01-06T04:00:00.0000000Z\",\"period\":\"PT30M\"},{\"pv_estimate\":0,\"pv_estimate10\":0,\"pv_estimate90\":0,\"period_end\":\"2022-01-06T04:30:00.0000000Z\",\"period\":\"PT30M\"},{\"pv_estimate\":0,\"pv_estimate10\":0,\"pv_estimate90\":0,\"period_end\":\"2022-01-06T05:00:00.0000000Z\",\"period\":\"PT30M\"},{\"pv_estimate\":0,\"pv_estimate10\":0,\"pv_estimate90\":0,\"period_end\":\"2022-01-06T05:30:00.0000000Z\",\"period\":\"PT30M\"},{\"pv_estimate\":0,\"pv_estimate10\":0,\"pv_estimate90\":0,\"period_end\":\"2022-01-06T06:00:00.0000000Z\",\"period\":\"PT30M\"},{\"pv_estimate\":0,\"pv_estimate10\":0,\"pv_estimate90\":0,\"period_end\":\"2022-01-06T06:30:00.0000000Z\",\"period\":\"PT30M\"},{\"pv_estimate\":0,\"pv_estimate10\":0,\"pv_estimate90\":0,\"period_end\":\"2022-01-06T07:00:00.0000000Z\",\"period\":\"PT30M\"},{\"pv_estimate\":0,\"pv_estimate10\":0,\"pv_estimate90\":0,\"period_end\":\"2022-01-06T07:30:00.0000000Z\",\"period\":\"PT30M\"},{\"pv_estimate\":0,\"pv_estimate10\":0,\"pv_estimate90\":0,\"period_end\":\"2022-01-06T08:00:00.0000000Z\",\"period\":\"PT30M\"},{\"pv_estimate\":0,\"pv_estimate10\":0,\"pv_estimate90\":0,\"period_end\":\"2022-01-06T08:30:00.0000000Z\",\"period\":\"PT30M\"},{\"pv_estimate\":0.0253,\"pv_estimate10\":0.0082,\"pv_estimate90\":0.026565000000000002,\"period_end\":\"2022-01-06T09:00:00.0000000Z\",\"period\":\"PT30M\"},{\"pv_estimate\":0.0744,\"pv_estimate10\":0.0221,\"pv_estimate90\":0.0812,\"period_end\":\"2022-01-06T09:30:00.0000000Z\",\"period\":\"PT30M\"},{\"pv_estimate\":0.1808,\"pv_estimate10\":0.053,\"pv_estimate90\":0.2403,\"period_end\":\"2022-01-06T10:00:00.0000000Z\",\"period\":\"PT30M\"},{\"pv_estimate\":0.3801,\"pv_estimate10\":0.1208,\"pv_estimate90\":0.5351,\"period_end\":\"2022-01-06T10:30:00.0000000Z\",\"period\":\"PT30M\"},{\"pv_estimate\":0.6348,\"pv_estimate10\":0.2167,\"pv_estimate90\":0.9553,\"period_end\":\"2022-01-06T11:00:00.0000000Z\",\"period\":\"PT30M\"},{\"pv_estimate\":0.879,\"pv_estimate10\":0.3107,\"pv_estimate90\":1.454,\"period_end\":\"2022-01-06T11:30:00.0000000Z\",\"period\":\"PT30M\"},{\"pv_estimate\":0.9709,\"pv_estimate10\":0.288,\"pv_estimate90\":1.8209,\"period_end\":\"2022-01-06T12:00:00.0000000Z\",\"period\":\"PT30M\"},{\"pv_estimate\":1.0066,\"pv_estimate10\":0.2535,\"pv_estimate90\":2.187,\"period_end\":\"2022-01-06T12:30:00.0000000Z\",\"period\":\"PT30M\"},{\"pv_estimate\":0,\"pv_estimate10\":0,\"pv_estimate90\":0,\"period_end\":\"2022-01-06T13:00:00.0000000Z\",\"period\":\"PT30M\"},{\"pv_estimate\":0.0873,\"pv_estimate10\":0.0172,\"pv_estimate90\":0.271,\"period_end\":\"2022-01-06T13:30:00.0000000Z\",\"period\":\"PT30M\"},{\"pv_estimate\":0.0905,\"pv_estimate10\":0.0169,\"pv_estimate90\":0.3501,\"period_end\":\"2022-01-06T14:00:00.0000000Z\",\"period\":\"PT30M\"},{\"pv_estimate\":0.0494,\"pv_estimate10\":0.0092,\"pv_estimate90\":0.2872,\"period_end\":\"2022-01-06T14:30:00.0000000Z\",\"period\":\"PT30M\"},{\"pv_estimate\":0.0212,\"pv_estimate10\":0.0036,\"pv_estimate90\":0.2075,\"period_end\":\"2022-01-06T15:00:00.0000000Z\",\"period\":\"PT30M\"},{\"pv_estimate\":0.0036,\"pv_estimate10\":0.0007,\"pv_estimate90\":0.0147,\"period_end\":\"2022-01-06T15:30:00.0000000Z\",\"period\":\"PT30M\"},{\"pv_estimate\":0,\"pv_estimate10\":0,\"pv_estimate90\":0,\"period_end\":\"2022-01-06T16:00:00.0000000Z\",\"period\":\"PT30M\"},{\"pv_estimate\":0,\"pv_estimate10\":0,\"pv_estimate90\":0,\"period_end\":\"2022-01-06T16:30:00.0000000Z\",\"period\":\"PT30M\"},{\"pv_estimate\":0,\"pv_estimate10\":0,\"pv_estimate90\":0,\"period_end\":\"2022-01-06T17:00:00.0000000Z\",\"period\":\"PT30M\"},{\"pv_estimate\":0,\"pv_estimate10\":0,\"pv_estimate90\":0,\"period_end\":\"2022-01-06T17:30:00.0000000Z\",\"period\":\"PT30M\"},{\"pv_estimate\":0,\"pv_estimate10\":0,\"pv_estimate90\":0,\"period_end\":\"2022-01-06T18:00:00.0000000Z\",\"period\":\"PT30M\"},{\"pv_estimate\":0,\"pv_estimate10\":0,\"pv_estimate90\":0,\"period_end\":\"2022-01-06T18:30:00.0000000Z\",\"period\":\"PT30M\"},{\"pv_estimate\":0,\"pv_estimate10\":0,\"pv_estimate90\":0,\"period_end\":\"2022-01-06T19:00:00.0000000Z\",\"period\":\"PT30M\"},{\"pv_estimate\":0,\"pv_estimate10\":0,\"pv_estimate90\":0,\"period_end\":\"2022-01-06T19:30:00.0000000Z\",\"period\":\"PT30M\"},{\"pv_estimate\":0,\"pv_estimate10\":0,\"pv_estimate90\":0,\"period_end\":\"2022-01-06T20:00:00.0000000Z\",\"period\":\"PT30M\"},{\"pv_estimate\":0,\"pv_estimate10\":0,\"pv_estimate90\":0,\"period_end\":\"2022-01-06T20:30:00.0000000Z\",\"period\":\"PT30M\"},{\"pv_estimate\":0,\"pv_estimate10\":0,\"pv_estimate90\":0,\"period_end\":\"2022-01-06T21:00:00.0000000Z\",\"period\":\"PT30M\"},{\"pv_estimate\":0,\"pv_estimate10\":0,\"pv_estimate90\":0,\"period_end\":\"2022-01-06T21:30:00.0000000Z\",\"period\":\"PT30M\"},{\"pv_estimate\":0,\"pv_estimate10\":0,\"pv_estimate90\":0,\"period_end\":\"2022-01-06T22:00:00.0000000Z\",\"period\":\"PT30M\"},{\"pv_estimate\":0,\"pv_estimate10\":0,\"pv_estimate90\":0,\"period_end\":\"2022-01-06T22:30:00.0000000Z\",\"period\":\"PT30M\"},{\"pv_estimate\":0,\"pv_estimate10\":0,\"pv_estimate90\":0,\"period_end\":\"2022-01-06T23:00:00.0000000Z\",\"period\":\"PT30M\"},{\"pv_estimate\":0,\"pv_estimate10\":0,\"pv_estimate90\":0,\"period_end\":\"2022-01-06T23:30:00.0000000Z\",\"period\":\"PT30M\"},{\"pv_estimate\":0,\"pv_estimate10\":0,\"pv_estimate90\":0,\"period_end\":\"2022-01-07T00:00:00.0000000Z\",\"period\":\"PT30M\"},{\"pv_estimate\":0,\"pv_estimate10\":0,\"pv_estimate90\":0,\"period_end\":\"2022-01-07T00:30:00.0000000Z\",\"period\":\"PT30M\"},{\"pv_estimate\":0,\"pv_estimate10\":0,\"pv_estimate90\":0,\"period_end\":\"2022-01-07T01:00:00.0000000Z\",\"period\":\"PT30M\"},{\"pv_estimate\":0,\"pv_estimate10\":0,\"pv_estimate90\":0,\"period_end\":\"2022-01-07T01:30:00.0000000Z\",\"period\":\"PT30M\"},{\"pv_estimate\":0,\"pv_estimate10\":0,\"pv_estimate90\":0,\"period_end\":\"2022-01-07T02:00:00.0000000Z\",\"period\":\"PT30M\"},{\"pv_estimate\":0,\"pv_estimate10\":0,\"pv_estimate90\":0,\"period_end\":\"2022-01-07T02:30:00.0000000Z\",\"period\":\"PT30M\"},{\"pv_estimate\":0,\"pv_estimate10\":0,\"pv_estimate90\":0,\"period_end\":\"2022-01-07T03:00:00.0000000Z\",\"period\":\"PT30M\"},{\"pv_estimate\":0,\"pv_estimate10\":0,\"pv_estimate90\":0,\"period_end\":\"2022-01-07T03:30:00.0000000Z\",\"period\":\"PT30M\"},{\"pv_estimate\":0,\"pv_estimate10\":0,\"pv_estimate90\":0,\"period_end\":\"2022-01-07T04:00:00.0000000Z\",\"period\":\"PT30M\"},{\"pv_estimate\":0,\"pv_estimate10\":0,\"pv_estimate90\":0,\"period_end\":\"2022-01-07T04:30:00.0000000Z\",\"period\":\"PT30M\"},{\"pv_estimate\":0,\"pv_estimate10\":0,\"pv_estimate90\":0,\"period_end\":\"2022-01-07T05:00:00.0000000Z\",\"period\":\"PT30M\"},{\"pv_estimate\":0,\"pv_estimate10\":0,\"pv_estimate90\":0,\"period_end\":\"2022-01-07T05:30:00.0000000Z\",\"period\":\"PT30M\"},{\"pv_estimate\":0,\"pv_estimate10\":0,\"pv_estimate90\":0,\"period_end\":\"2022-01-07T06:00:00.0000000Z\",\"period\":\"PT30M\"},{\"pv_estimate\":0,\"pv_estimate10\":0,\"pv_estimate90\":0,\"period_end\":\"2022-01-07T06:30:00.0000000Z\",\"period\":\"PT30M\"},{\"pv_estimate\":0,\"pv_estimate10\":0,\"pv_estimate90\":0,\"period_end\":\"2022-01-07T07:00:00.0000000Z\",\"period\":\"PT30M\"},{\"pv_estimate\":0.0098,\"pv_estimate10\":0.0052,\"pv_estimate90\":0.0098,\"period_end\":\"2022-01-07T07:30:00.0000000Z\",\"period\":\"PT30M\"},{\"pv_estimate\":0.0228,\"pv_estimate10\":0.0193,\"pv_estimate90\":0.023940000000000003,\"period_end\":\"2022-01-07T08:00:00.0000000Z\",\"period\":\"PT30M\"},{\"pv_estimate\":0.0195,\"pv_estimate10\":0.018525,\"pv_estimate90\":0.020475,\"period_end\":\"2022-01-07T08:30:00.0000000Z\",\"period\":\"PT30M\"},{\"pv_estimate\":0.0207,\"pv_estimate10\":0.019665,\"pv_estimate90\":0.021735,\"period_end\":\"2022-01-07T09:00:00.0000000Z\",\"period\":\"PT30M\"},{\"pv_estimate\":0.1015,\"pv_estimate10\":0.0815,\"pv_estimate90\":0.10657500000000002,\"period_end\":\"2022-01-07T09:30:00.0000000Z\",\"period\":\"PT30M\"},{\"pv_estimate\":0.3003,\"pv_estimate10\":0.1738,\"pv_estimate90\":0.3003,\"period_end\":\"2022-01-07T10:00:00.0000000Z\",\"period\":\"PT30M\"},{\"pv_estimate\":0.592,\"pv_estimate10\":0.2657,\"pv_estimate90\":0.592,\"period_end\":\"2022-01-07T10:30:00.0000000Z\",\"period\":\"PT30M\"},{\"pv_estimate\":1.0624,\"pv_estimate10\":0.4085,\"pv_estimate90\":1.0624,\"period_end\":\"2022-01-07T11:00:00.0000000Z\",\"period\":\"PT30M\"},{\"pv_estimate\":1.6071,\"pv_estimate10\":0.5217,\"pv_estimate90\":1.6071,\"period_end\":\"2022-01-07T11:30:00.0000000Z\",\"period\":\"PT30M\"},{\"pv_estimate\":2.0698,\"pv_estimate10\":0.5589,\"pv_estimate90\":2.0698,\"period_end\":\"2022-01-07T12:00:00.0000000Z\",\"period\":\"PT30M\"},{\"pv_estimate\":2.4785,\"pv_estimate10\":0.533,\"pv_estimate90\":2.4785,\"period_end\":\"2022-01-07T12:30:00.0000000Z\",\"period\":\"PT30M\"},{\"pv_estimate\":2.8974,\"pv_estimate10\":0.5608,\"pv_estimate90\":2.8974,\"period_end\":\"2022-01-07T13:00:00.0000000Z\",\"period\":\"PT30M\"},{\"pv_estimate\":2.8983,\"pv_estimate10\":0.4311,\"pv_estimate90\":2.8983,\"period_end\":\"2022-01-07T13:30:00.0000000Z\",\"period\":\"PT30M\"},{\"pv_estimate\":2.8199,\"pv_estimate10\":0.3014,\"pv_estimate90\":2.8199,\"period_end\":\"2022-01-07T14:00:00.0000000Z\",\"period\":\"PT30M\"},{\"pv_estimate\":2.3114,\"pv_estimate10\":0.1929,\"pv_estimate90\":2.3114,\"period_end\":\"2022-01-07T14:30:00.0000000Z\",\"period\":\"PT30M\"},{\"pv_estimate\":1.8762,\"pv_estimate10\":0.0998,\"pv_estimate90\":1.8762,\"period_end\":\"2022-01-07T15:00:00.0000000Z\",\"period\":\"PT30M\"},{\"pv_estimate\":0.1885,\"pv_estimate10\":0.0216,\"pv_estimate90\":0.1885,\"period_end\":\"2022-01-07T15:30:00.0000000Z\",\"period\":\"PT30M\"},{\"pv_estimate\":0,\"pv_estimate10\":0,\"pv_estimate90\":0,\"period_end\":\"2022-01-07T16:00:00.0000000Z\",\"period\":\"PT30M\"},{\"pv_estimate\":0,\"pv_estimate10\":0,\"pv_estimate90\":0,\"period_end\":\"2022-01-07T16:30:00.0000000Z\",\"period\":\"PT30M\"},{\"pv_estimate\":0,\"pv_estimate10\":0,\"pv_estimate90\":0,\"period_end\":\"2022-01-07T17:00:00.0000000Z\",\"period\":\"PT30M\"},{\"pv_estimate\":0,\"pv_estimate10\":0,\"pv_estimate90\":0,\"period_end\":\"2022-01-07T17:30:00.0000000Z\",\"period\":\"PT30M\"},{\"pv_estimate\":0,\"pv_estimate10\":0,\"pv_estimate90\":0,\"period_end\":\"2022-01-07T18:00:00.0000000Z\",\"period\":\"PT30M\"},{\"pv_estimate\":0,\"pv_estimate10\":0,\"pv_estimate90\":0,\"period_end\":\"2022-01-07T18:30:00.0000000Z\",\"period\":\"PT30M\"},{\"pv_estimate\":0,\"pv_estimate10\":0,\"pv_estimate90\":0,\"period_end\":\"2022-01-07T19:00:00.0000000Z\",\"period\":\"PT30M\"},{\"pv_estimate\":0,\"pv_estimate10\":0,\"pv_estimate90\":0,\"period_end\":\"2022-01-07T19:30:00.0000000Z\",\"period\":\"PT30M\"},{\"pv_estimate\":0,\"pv_estimate10\":0,\"pv_estimate90\":0,\"period_end\":\"2022-01-07T20:00:00.0000000Z\",\"period\":\"PT30M\"},{\"pv_estimate\":0,\"pv_estimate10\":0,\"pv_estimate90\":0,\"period_end\":\"2022-01-07T20:30:00.0000000Z\",\"period\":\"PT30M\"},{\"pv_estimate\":0,\"pv_estimate10\":0,\"pv_estimate90\":0,\"period_end\":\"2022-01-07T21:00:00.0000000Z\",\"period\":\"PT30M\"},{\"pv_estimate\":0,\"pv_estimate10\":0,\"pv_estimate90\":0,\"period_end\":\"2022-01-07T21:30:00.0000000Z\",\"period\":\"PT30M\"},{\"pv_estimate\":0,\"pv_estimate10\":0,\"pv_estimate90\":0,\"period_end\":\"2022-01-07T22:00:00.0000000Z\",\"period\":\"PT30M\"},{\"pv_estimate\":0,\"pv_estimate10\":0,\"pv_estimate90\":0,\"period_end\":\"2022-01-07T22:30:00.0000000Z\",\"period\":\"PT30M\"},{\"pv_estimate\":0,\"pv_estimate10\":0,\"pv_estimate90\":0,\"period_end\":\"2022-01-07T23:00:00.0000000Z\",\"period\":\"PT30M\"},{\"pv_estimate\":0,\"pv_estimate10\":0,\"pv_estimate90\":0,\"period_end\":\"2022-01-07T23:30:00.0000000Z\",\"period\":\"PT30M\"},{\"pv_estimate\":0,\"pv_estimate10\":0,\"pv_estimate90\":0,\"period_end\":\"2022-01-08T00:00:00.0000000Z\",\"period\":\"PT30M\"},{\"pv_estimate\":0,\"pv_estimate10\":0,\"pv_estimate90\":0,\"period_end\":\"2022-01-08T00:30:00.0000000Z\",\"period\":\"PT30M\"},{\"pv_estimate\":0,\"pv_estimate10\":0,\"pv_estimate90\":0,\"period_end\":\"2022-01-08T01:00:00.0000000Z\",\"period\":\"PT30M\"},{\"pv_estimate\":0,\"pv_estimate10\":0,\"pv_estimate90\":0,\"period_end\":\"2022-01-08T01:30:00.0000000Z\",\"period\":\"PT30M\"},{\"pv_estimate\":0,\"pv_estimate10\":0,\"pv_estimate90\":0,\"period_end\":\"2022-01-08T02:00:00.0000000Z\",\"period\":\"PT30M\"},{\"pv_estimate\":0,\"pv_estimate10\":0,\"pv_estimate90\":0,\"period_end\":\"2022-01-08T02:30:00.0000000Z\",\"period\":\"PT30M\"},{\"pv_estimate\":0,\"pv_estimate10\":0,\"pv_estimate90\":0,\"period_end\":\"2022-01-08T03:00:00.0000000Z\",\"period\":\"PT30M\"},{\"pv_estimate\":0,\"pv_estimate10\":0,\"pv_estimate90\":0,\"period_end\":\"2022-01-08T03:30:00.0000000Z\",\"period\":\"PT30M\"},{\"pv_estimate\":0,\"pv_estimate10\":0,\"pv_estimate90\":0,\"period_end\":\"2022-01-08T04:00:00.0000000Z\",\"period\":\"PT30M\"},{\"pv_estimate\":0,\"pv_estimate10\":0,\"pv_estimate90\":0,\"period_end\":\"2022-01-08T04:30:00.0000000Z\",\"period\":\"PT30M\"},{\"pv_estimate\":0,\"pv_estimate10\":0,\"pv_estimate90\":0,\"period_end\":\"2022-01-08T05:00:00.0000000Z\",\"period\":\"PT30M\"},{\"pv_estimate\":0,\"pv_estimate10\":0,\"pv_estimate90\":0,\"period_end\":\"2022-01-08T05:30:00.0000000Z\",\"period\":\"PT30M\"},{\"pv_estimate\":0,\"pv_estimate10\":0,\"pv_estimate90\":0,\"period_end\":\"2022-01-08T06:00:00.0000000Z\",\"period\":\"PT30M\"},{\"pv_estimate\":0,\"pv_estimate10\":0,\"pv_estimate90\":0,\"period_end\":\"2022-01-08T06:30:00.0000000Z\",\"period\":\"PT30M\"},{\"pv_estimate\":0,\"pv_estimate10\":0,\"pv_estimate90\":0,\"period_end\":\"2022-01-08T07:00:00.0000000Z\",\"period\":\"PT30M\"},{\"pv_estimate\":0.0368,\"pv_estimate10\":0.0053,\"pv_estimate90\":0.0597,\"period_end\":\"2022-01-08T07:30:00.0000000Z\",\"period\":\"PT30M\"},{\"pv_estimate\":0.1515,\"pv_estimate10\":0.0263,\"pv_estimate90\":0.1697,\"period_end\":\"2022-01-08T08:00:00.0000000Z\",\"period\":\"PT30M\"},{\"pv_estimate\":0.2902,\"pv_estimate10\":0.0525,\"pv_estimate90\":0.30471000000000004,\"period_end\":\"2022-01-08T08:30:00.0000000Z\",\"period\":\"PT30M\"},{\"pv_estimate\":0.5478,\"pv_estimate10\":0.0866,\"pv_estimate90\":0.57519,\"period_end\":\"2022-01-08T09:00:00.0000000Z\",\"period\":\"PT30M\"},{\"pv_estimate\":0.8586,\"pv_estimate10\":0.1299,\"pv_estimate90\":0.90153,\"period_end\":\"2022-01-08T09:30:00.0000000Z\",\"period\":\"PT30M\"},{\"pv_estimate\":1.1479,\"pv_estimate10\":0.1589,\"pv_estimate90\":1.4729,\"period_end\":\"2022-01-08T10:00:00.0000000Z\",\"period\":\"PT30M\"},{\"pv_estimate\":1.4053,\"pv_estimate10\":0.2081,\"pv_estimate90\":2.2035,\"period_end\":\"2022-01-08T10:30:00.0000000Z\",\"period\":\"PT30M\"},{\"pv_estimate\":0,\"pv_estimate10\":0,\"pv_estimate90\":0,\"period_end\":\"2022-01-08T11:00:00.0000000Z\",\"period\":\"PT30M\"},{\"pv_estimate\":0.1905,\"pv_estimate10\":0.0258,\"pv_estimate90\":0.3589,\"period_end\":\"2022-01-08T11:30:00.0000000Z\",\"period\":\"PT30M\"},{\"pv_estimate\":0.3234,\"pv_estimate10\":0.0418,\"pv_estimate90\":0.6688,\"period_end\":\"2022-01-08T12:00:00.0000000Z\",\"period\":\"PT30M\"},{\"pv_estimate\":0.4557,\"pv_estimate10\":0.0617,\"pv_estimate90\":0.9661,\"period_end\":\"2022-01-08T12:30:00.0000000Z\",\"period\":\"PT30M\"},{\"pv_estimate\":0.6004,\"pv_estimate10\":0.0856,\"pv_estimate90\":1.2588,\"period_end\":\"2022-01-08T13:00:00.0000000Z\",\"period\":\"PT30M\"},{\"pv_estimate\":0.7032,\"pv_estimate10\":0.1021,\"pv_estimate90\":1.476,\"period_end\":\"2022-01-08T13:30:00.0000000Z\",\"period\":\"PT30M\"},{\"pv_estimate\":0.786,\"pv_estimate10\":0.0995,\"pv_estimate90\":1.6042,\"period_end\":\"2022-01-08T14:00:00.0000000Z\",\"period\":\"PT30M\"},{\"pv_estimate\":0.6593,\"pv_estimate10\":0.0796,\"pv_estimate90\":1.334,\"period_end\":\"2022-01-08T14:30:00.0000000Z\",\"period\":\"PT30M\"},{\"pv_estimate\":0.5605,\"pv_estimate10\":0.049,\"pv_estimate90\":1.0464,\"period_end\":\"2022-01-08T15:00:00.0000000Z\",\"period\":\"PT30M\"},{\"pv_estimate\":0.0686,\"pv_estimate10\":0.0122,\"pv_estimate90\":0.1256,\"period_end\":\"2022-01-08T15:30:00.0000000Z\",\"period\":\"PT30M\"},{\"pv_estimate\":0,\"pv_estimate10\":0,\"pv_estimate90\":0,\"period_end\":\"2022-01-08T16:00:00.0000000Z\",\"period\":\"PT30M\"},{\"pv_estimate\":0,\"pv_estimate10\":0,\"pv_estimate90\":0,\"period_end\":\"2022-01-08T16:30:00.0000000Z\",\"period\":\"PT30M\"},{\"pv_estimate\":0,\"pv_estimate10\":0,\"pv_estimate90\":0,\"period_end\":\"2022-01-08T17:00:00.0000000Z\",\"period\":\"PT30M\"},{\"pv_estimate\":0,\"pv_estimate10\":0,\"pv_estimate90\":0,\"period_end\":\"2022-01-08T17:30:00.0000000Z\",\"period\":\"PT30M\"},{\"pv_estimate\":0,\"pv_estimate10\":0,\"pv_estimate90\":0,\"period_end\":\"2022-01-08T18:00:00.0000000Z\",\"period\":\"PT30M\"},{\"pv_estimate\":0,\"pv_estimate10\":0,\"pv_estimate90\":0,\"period_end\":\"2022-01-08T18:30:00.0000000Z\",\"period\":\"PT30M\"},{\"pv_estimate\":0,\"pv_estimate10\":0,\"pv_estimate90\":0,\"period_end\":\"2022-01-08T19:00:00.0000000Z\",\"period\":\"PT30M\"},{\"pv_estimate\":0,\"pv_estimate10\":0,\"pv_estimate90\":0,\"period_end\":\"2022-01-08T19:30:00.0000000Z\",\"period\":\"PT30M\"},{\"pv_estimate\":0,\"pv_estimate10\":0,\"pv_estimate90\":0,\"period_end\":\"2022-01-08T20:00:00.0000000Z\",\"period\":\"PT30M\"},{\"pv_estimate\":0,\"pv_estimate10\":0,\"pv_estimate90\":0,\"period_end\":\"2022-01-08T20:30:00.0000000Z\",\"period\":\"PT30M\"},{\"pv_estimate\":0,\"pv_estimate10\":0,\"pv_estimate90\":0,\"period_end\":\"2022-01-08T21:00:00.0000000Z\",\"period\":\"PT30M\"},{\"pv_estimate\":0,\"pv_estimate10\":0,\"pv_estimate90\":0,\"period_end\":\"2022-01-08T21:30:00.0000000Z\",\"period\":\"PT30M\"},{\"pv_estimate\":0,\"pv_estimate10\":0,\"pv_estimate90\":0,\"period_end\":\"2022-01-08T22:00:00.0000000Z\",\"period\":\"PT30M\"},{\"pv_estimate\":0,\"pv_estimate10\":0,\"pv_estimate90\":0,\"period_end\":\"2022-01-08T22:30:00.0000000Z\",\"period\":\"PT30M\"},{\"pv_estimate\":0,\"pv_estimate10\":0,\"pv_estimate90\":0,\"period_end\":\"2022-01-08T23:00:00.0000000Z\",\"period\":\"PT30M\"},{\"pv_estimate\":0,\"pv_estimate10\":0,\"pv_estimate90\":0,\"period_end\":\"2022-01-08T23:30:00.0000000Z\",\"period\":\"PT30M\"},{\"pv_estimate\":0,\"pv_estimate10\":0,\"pv_estimate90\":0,\"period_end\":\"2022-01-09T00:00:00.0000000Z\",\"period\":\"PT30M\"},{\"pv_estimate\":0,\"pv_estimate10\":0,\"pv_estimate90\":0,\"period_end\":\"2022-01-09T00:30:00.0000000Z\",\"period\":\"PT30M\"},{\"pv_estimate\":0,\"pv_estimate10\":0,\"pv_estimate90\":0,\"period_end\":\"2022-01-09T01:00:00.0000000Z\",\"period\":\"PT30M\"},{\"pv_estimate\":0,\"pv_estimate10\":0,\"pv_estimate90\":0,\"period_end\":\"2022-01-09T01:30:00.0000000Z\",\"period\":\"PT30M\"},{\"pv_estimate\":0,\"pv_estimate10\":0,\"pv_estimate90\":0,\"period_end\":\"2022-01-09T02:00:00.0000000Z\",\"period\":\"PT30M\"},{\"pv_estimate\":0,\"pv_estimate10\":0,\"pv_estimate90\":0,\"period_end\":\"2022-01-09T02:30:00.0000000Z\",\"period\":\"PT30M\"},{\"pv_estimate\":0,\"pv_estimate10\":0,\"pv_estimate90\":0,\"period_end\":\"2022-01-09T03:00:00.0000000Z\",\"period\":\"PT30M\"},{\"pv_estimate\":0,\"pv_estimate10\":0,\"pv_estimate90\":0,\"period_end\":\"2022-01-09T03:30:00.0000000Z\",\"period\":\"PT30M\"},{\"pv_estimate\":0,\"pv_estimate10\":0,\"pv_estimate90\":0,\"period_end\":\"2022-01-09T04:00:00.0000000Z\",\"period\":\"PT30M\"},{\"pv_estimate\":0,\"pv_estimate10\":0,\"pv_estimate90\":0,\"period_end\":\"2022-01-09T04:30:00.0000000Z\",\"period\":\"PT30M\"},{\"pv_estimate\":0,\"pv_estimate10\":0,\"pv_estimate90\":0,\"period_end\":\"2022-01-09T05:00:00.0000000Z\",\"period\":\"PT30M\"},{\"pv_estimate\":0,\"pv_estimate10\":0,\"pv_estimate90\":0,\"period_end\":\"2022-01-09T05:30:00.0000000Z\",\"period\":\"PT30M\"},{\"pv_estimate\":0,\"pv_estimate10\":0,\"pv_estimate90\":0,\"period_end\":\"2022-01-09T06:00:00.0000000Z\",\"period\":\"PT30M\"},{\"pv_estimate\":0,\"pv_estimate10\":0,\"pv_estimate90\":0,\"period_end\":\"2022-01-09T06:30:00.0000000Z\",\"period\":\"PT30M\"},{\"pv_estimate\":0,\"pv_estimate10\":0,\"pv_estimate90\":0,\"period_end\":\"2022-01-09T07:00:00.0000000Z\",\"period\":\"PT30M\"},{\"pv_estimate\":0.0155,\"pv_estimate10\":0.0031,\"pv_estimate90\":0.0353,\"period_end\":\"2022-01-09T07:30:00.0000000Z\",\"period\":\"PT30M\"},{\"pv_estimate\":0.0679,\"pv_estimate10\":0.0062,\"pv_estimate90\":0.1045,\"period_end\":\"2022-01-09T08:00:00.0000000Z\",\"period\":\"PT30M\"},{\"pv_estimate\":0.1268,\"pv_estimate10\":0.0124,\"pv_estimate90\":0.13314,\"period_end\":\"2022-01-09T08:30:00.0000000Z\",\"period\":\"PT30M\"},{\"pv_estimate\":0.2163,\"pv_estimate10\":0.0153,\"pv_estimate90\":0.227115,\"period_end\":\"2022-01-09T09:00:00.0000000Z\",\"period\":\"PT30M\"},{\"pv_estimate\":0.3527,\"pv_estimate10\":0.0231,\"pv_estimate90\":0.5187,\"period_end\":\"2022-01-09T09:30:00.0000000Z\",\"period\":\"PT30M\"},{\"pv_estimate\":0.5043,\"pv_estimate10\":0.0282,\"pv_estimate90\":0.8693,\"period_end\":\"2022-01-09T10:00:00.0000000Z\",\"period\":\"PT30M\"},{\"pv_estimate\":0.6355,\"pv_estimate10\":0.0339,\"pv_estimate90\":1.3038,\"period_end\":\"2022-01-09T10:30:00.0000000Z\",\"period\":\"PT30M\"},{\"pv_estimate\":0.7972,\"pv_estimate10\":0.0501,\"pv_estimate90\":1.7409,\"period_end\":\"2022-01-09T11:00:00.0000000Z\",\"period\":\"PT30M\"},{\"pv_estimate\":0.908,\"pv_estimate10\":0.065,\"pv_estimate90\":2.1664,\"period_end\":\"2022-01-09T11:30:00.0000000Z\",\"period\":\"PT30M\"},{\"pv_estimate\":0.9863,\"pv_estimate10\":0.0868,\"pv_estimate90\":2.5519,\"period_end\":\"2022-01-09T12:00:00.0000000Z\",\"period\":\"PT30M\"},{\"pv_estimate\":1.0004,\"pv_estimate10\":0.0891,\"pv_estimate90\":2.8391,\"period_end\":\"2022-01-09T12:30:00.0000000Z\",\"period\":\"PT30M\"},{\"pv_estimate\":0.9535,\"pv_estimate10\":0.0845,\"pv_estimate90\":2.9704,\"period_end\":\"2022-01-09T13:00:00.0000000Z\",\"period\":\"PT30M\"},{\"pv_estimate\":0.7453,\"pv_estimate10\":0.0877,\"pv_estimate90\":2.8574,\"period_end\":\"2022-01-09T13:30:00.0000000Z\",\"period\":\"PT30M\"},{\"pv_estimate\":0,\"pv_estimate10\":0,\"pv_estimate90\":0,\"period_end\":\"2022-01-09T14:00:00.0000000Z\",\"period\":\"PT30M\"},{\"pv_estimate\":0,\"pv_estimate10\":0,\"pv_estimate90\":0,\"period_end\":\"2022-01-09T14:30:00.0000000Z\",\"period\":\"PT30M\"},{\"pv_estimate\":0,\"pv_estimate10\":0,\"pv_estimate90\":0,\"period_end\":\"2022-01-09T15:00:00.0000000Z\",\"period\":\"PT30M\"},{\"pv_estimate\":0,\"pv_estimate10\":0,\"pv_estimate90\":0,\"period_end\":\"2022-01-09T15:30:00.0000000Z\",\"period\":\"PT30M\"},{\"pv_estimate\":0,\"pv_estimate10\":0,\"pv_estimate90\":0,\"period_end\":\"2022-01-09T16:00:00.0000000Z\",\"period\":\"PT30M\"},{\"pv_estimate\":0,\"pv_estimate10\":0,\"pv_estimate90\":0,\"period_end\":\"2022-01-09T16:30:00.0000000Z\",\"period\":\"PT30M\"},{\"pv_estimate\":0,\"pv_estimate10\":0,\"pv_estimate90\":0,\"period_end\":\"2022-01-09T17:00:00.0000000Z\",\"period\":\"PT30M\"},{\"pv_estimate\":0,\"pv_estimate10\":0,\"pv_estimate90\":0,\"period_end\":\"2022-01-09T17:30:00.0000000Z\",\"period\":\"PT30M\"},{\"pv_estimate\":0,\"pv_estimate10\":0,\"pv_estimate90\":0,\"period_end\":\"2022-01-09T18:00:00.0000000Z\",\"period\":\"PT30M\"},{\"pv_estimate\":0,\"pv_estimate10\":0,\"pv_estimate90\":0,\"period_end\":\"2022-01-09T18:30:00.0000000Z\",\"period\":\"PT30M\"},{\"pv_estimate\":0,\"pv_estimate10\":0,\"pv_estimate90\":0,\"period_end\":\"2022-01-09T19:00:00.0000000Z\",\"period\":\"PT30M\"},{\"pv_estimate\":0,\"pv_estimate10\":0,\"pv_estimate90\":0,\"period_end\":\"2022-01-09T19:30:00.0000000Z\",\"period\":\"PT30M\"},{\"pv_estimate\":0,\"pv_estimate10\":0,\"pv_estimate90\":0,\"period_end\":\"2022-01-09T20:00:00.0000000Z\",\"period\":\"PT30M\"},{\"pv_estimate\":0,\"pv_estimate10\":0,\"pv_estimate90\":0,\"period_end\":\"2022-01-09T20:30:00.0000000Z\",\"period\":\"PT30M\"},{\"pv_estimate\":0,\"pv_estimate10\":0,\"pv_estimate90\":0,\"period_end\":\"2022-01-09T21:00:00.0000000Z\",\"period\":\"PT30M\"},{\"pv_estimate\":0,\"pv_estimate10\":0,\"pv_estimate90\":0,\"period_end\":\"2022-01-09T21:30:00.0000000Z\",\"period\":\"PT30M\"},{\"pv_estimate\":0,\"pv_estimate10\":0,\"pv_estimate90\":0,\"period_end\":\"2022-01-09T22:00:00.0000000Z\",\"period\":\"PT30M\"},{\"pv_estimate\":0,\"pv_estimate10\":0,\"pv_estimate90\":0,\"period_end\":\"2022-01-09T22:30:00.0000000Z\",\"period\":\"PT30M\"},{\"pv_estimate\":0,\"pv_estimate10\":0,\"pv_estimate90\":0,\"period_end\":\"2022-01-09T23:00:00.0000000Z\",\"period\":\"PT30M\"},{\"pv_estimate\":0,\"pv_estimate10\":0,\"pv_estimate90\":0,\"period_end\":\"2022-01-09T23:30:00.0000000Z\",\"period\":\"PT30M\"},{\"pv_estimate\":0,\"pv_estimate10\":0,\"pv_estimate90\":0,\"period_end\":\"2022-01-10T00:00:00.0000000Z\",\"period\":\"PT30M\"},{\"pv_estimate\":0,\"pv_estimate10\":0,\"pv_estimate90\":0,\"period_end\":\"2022-01-10T00:30:00.0000000Z\",\"period\":\"PT30M\"},{\"pv_estimate\":0,\"pv_estimate10\":0,\"pv_estimate90\":0,\"period_end\":\"2022-01-10T01:00:00.0000000Z\",\"period\":\"PT30M\"},{\"pv_estimate\":0,\"pv_estimate10\":0,\"pv_estimate90\":0,\"period_end\":\"2022-01-10T01:30:00.0000000Z\",\"period\":\"PT30M\"},{\"pv_estimate\":0,\"pv_estimate10\":0,\"pv_estimate90\":0,\"period_end\":\"2022-01-10T02:00:00.0000000Z\",\"period\":\"PT30M\"},{\"pv_estimate\":0,\"pv_estimate10\":0,\"pv_estimate90\":0,\"period_end\":\"2022-01-10T02:30:00.0000000Z\",\"period\":\"PT30M\"},{\"pv_estimate\":0,\"pv_estimate10\":0,\"pv_estimate90\":0,\"period_end\":\"2022-01-10T03:00:00.0000000Z\",\"period\":\"PT30M\"},{\"pv_estimate\":0,\"pv_estimate10\":0,\"pv_estimate90\":0,\"period_end\":\"2022-01-10T03:30:00.0000000Z\",\"period\":\"PT30M\"},{\"pv_estimate\":0,\"pv_estimate10\":0,\"pv_estimate90\":0,\"period_end\":\"2022-01-10T04:00:00.0000000Z\",\"period\":\"PT30M\"},{\"pv_estimate\":0,\"pv_estimate10\":0,\"pv_estimate90\":0,\"period_end\":\"2022-01-10T04:30:00.0000000Z\",\"period\":\"PT30M\"},{\"pv_estimate\":0,\"pv_estimate10\":0,\"pv_estimate90\":0,\"period_end\":\"2022-01-10T05:00:00.0000000Z\",\"period\":\"PT30M\"},{\"pv_estimate\":0,\"pv_estimate10\":0,\"pv_estimate90\":0,\"period_end\":\"2022-01-10T05:30:00.0000000Z\",\"period\":\"PT30M\"},{\"pv_estimate\":0,\"pv_estimate10\":0,\"pv_estimate90\":0,\"period_end\":\"2022-01-10T06:00:00.0000000Z\",\"period\":\"PT30M\"},{\"pv_estimate\":0,\"pv_estimate10\":0,\"pv_estimate90\":0,\"period_end\":\"2022-01-10T06:30:00.0000000Z\",\"period\":\"PT30M\"},{\"pv_estimate\":0,\"pv_estimate10\":0,\"pv_estimate90\":0,\"period_end\":\"2022-01-10T07:00:00.0000000Z\",\"period\":\"PT30M\"},{\"pv_estimate\":0,\"pv_estimate10\":0,\"pv_estimate90\":0,\"period_end\":\"2022-01-10T07:30:00.0000000Z\",\"period\":\"PT30M\"},{\"pv_estimate\":0,\"pv_estimate10\":0,\"pv_estimate90\":0,\"period_end\":\"2022-01-10T08:00:00.0000000Z\",\"period\":\"PT30M\"},{\"pv_estimate\":0,\"pv_estimate10\":0,\"pv_estimate90\":0,\"period_end\":\"2022-01-10T08:30:00.0000000Z\",\"period\":\"PT30M\"},{\"pv_estimate\":0,\"pv_estimate10\":0,\"pv_estimate90\":0,\"period_end\":\"2022-01-10T09:00:00.0000000Z\",\"period\":\"PT30M\"},{\"pv_estimate\":0,\"pv_estimate10\":0,\"pv_estimate90\":0,\"period_end\":\"2022-01-10T09:30:00.0000000Z\",\"period\":\"PT30M\"},{\"pv_estimate\":0.0392,\"pv_estimate10\":0.0047,\"pv_estimate90\":0.0583,\"period_end\":\"2022-01-10T10:00:00.0000000Z\",\"period\":\"PT30M\"},{\"pv_estimate\":0.1387,\"pv_estimate10\":0.0177,\"pv_estimate90\":0.2421,\"period_end\":\"2022-01-10T10:30:00.0000000Z\",\"period\":\"PT30M\"},{\"pv_estimate\":0.2003,\"pv_estimate10\":0.0245,\"pv_estimate90\":0.4019,\"period_end\":\"2022-01-10T11:00:00.0000000Z\",\"period\":\"PT30M\"},{\"pv_estimate\":0.3075,\"pv_estimate10\":0.0395,\"pv_estimate90\":0.6861,\"period_end\":\"2022-01-10T11:30:00.0000000Z\",\"period\":\"PT30M\"},{\"pv_estimate\":0.3737,\"pv_estimate10\":0.0445,\"pv_estimate90\":0.8752,\"period_end\":\"2022-01-10T12:00:00.0000000Z\",\"period\":\"PT30M\"},{\"pv_estimate\":0.3929,\"pv_estimate10\":0.0471,\"pv_estimate90\":1.0603,\"period_end\":\"2022-01-10T12:30:00.0000000Z\",\"period\":\"PT30M\"},{\"pv_estimate\":0.4452,\"pv_estimate10\":0.0541,\"pv_estimate90\":1.3762,\"period_end\":\"2022-01-10T13:00:00.0000000Z\",\"period\":\"PT30M\"},{\"pv_estimate\":0.3502,\"pv_estimate10\":0.0471,\"pv_estimate90\":1.3221,\"period_end\":\"2022-01-10T13:30:00.0000000Z\",\"period\":\"PT30M\"},{\"pv_estimate\":0.2823,\"pv_estimate10\":0.0363,\"pv_estimate90\":1.3686,\"period_end\":\"2022-01-10T14:00:00.0000000Z\",\"period\":\"PT30M\"},{\"pv_estimate\":0.1678,\"pv_estimate10\":0.0259,\"pv_estimate90\":1.1502,\"period_end\":\"2022-01-10T14:30:00.0000000Z\",\"period\":\"PT30M\"},{\"pv_estimate\":0.0854,\"pv_estimate10\":0.0129,\"pv_estimate90\":0.7322,\"period_end\":\"2022-01-10T15:00:00.0000000Z\",\"period\":\"PT30M\"},{\"pv_estimate\":0.021,\"pv_estimate10\":0.0026,\"pv_estimate90\":0.1127,\"period_end\":\"2022-01-10T15:30:00.0000000Z\",\"period\":\"PT30M\"},{\"pv_estimate\":0,\"pv_estimate10\":0,\"pv_estimate90\":0,\"period_end\":\"2022-01-10T16:00:00.0000000Z\",\"period\":\"PT30M\"},{\"pv_estimate\":0,\"pv_estimate10\":0,\"pv_estimate90\":0,\"period_end\":\"2022-01-10T16:30:00.0000000Z\",\"period\":\"PT30M\"},{\"pv_estimate\":0,\"pv_estimate10\":0,\"pv_estimate90\":0,\"period_end\":\"2022-01-10T17:00:00.0000000Z\",\"period\":\"PT30M\"},{\"pv_estimate\":0,\"pv_estimate10\":0,\"pv_estimate90\":0,\"period_end\":\"2022-01-10T17:30:00.0000000Z\",\"period\":\"PT30M\"},{\"pv_estimate\":0,\"pv_estimate10\":0,\"pv_estimate90\":0,\"period_end\":\"2022-01-10T18:00:00.0000000Z\",\"period\":\"PT30M\"},{\"pv_estimate\":0,\"pv_estimate10\":0,\"pv_estimate90\":0,\"period_end\":\"2022-01-10T18:30:00.0000000Z\",\"period\":\"PT30M\"},{\"pv_estimate\":0,\"pv_estimate10\":0,\"pv_estimate90\":0,\"period_end\":\"2022-01-10T19:00:00.0000000Z\",\"period\":\"PT30M\"},{\"pv_estimate\":0,\"pv_estimate10\":0,\"pv_estimate90\":0,\"period_end\":\"2022-01-10T19:30:00.0000000Z\",\"period\":\"PT30M\"},{\"pv_estimate\":0,\"pv_estimate10\":0,\"pv_estimate90\":0,\"period_end\":\"2022-01-10T20:00:00.0000000Z\",\"period\":\"PT30M\"},{\"pv_estimate\":0,\"pv_estimate10\":0,\"pv_estimate90\":0,\"period_end\":\"2022-01-10T20:30:00.0000000Z\",\"period\":\"PT30M\"},{\"pv_estimate\":0,\"pv_estimate10\":0,\"pv_estimate90\":0,\"period_end\":\"2022-01-10T21:00:00.0000000Z\",\"period\":\"PT30M\"},{\"pv_estimate\":0,\"pv_estimate10\":0,\"pv_estimate90\":0,\"period_end\":\"2022-01-10T21:30:00.0000000Z\",\"period\":\"PT30M\"},{\"pv_estimate\":0,\"pv_estimate10\":0,\"pv_estimate90\":0,\"period_end\":\"2022-01-10T22:00:00.0000000Z\",\"period\":\"PT30M\"},{\"pv_estimate\":0,\"pv_estimate10\":0,\"pv_estimate90\":0,\"period_end\":\"2022-01-10T22:30:00.0000000Z\",\"period\":\"PT30M\"},{\"pv_estimate\":0,\"pv_estimate10\":0,\"pv_estimate90\":0,\"period_end\":\"2022-01-10T23:00:00.0000000Z\",\"period\":\"PT30M\"},{\"pv_estimate\":0,\"pv_estimate10\":0,\"pv_estimate90\":0,\"period_end\":\"2022-01-10T23:30:00.0000000Z\",\"period\":\"PT30M\"},{\"pv_estimate\":0,\"pv_estimate10\":0,\"pv_estimate90\":0,\"period_end\":\"2022-01-11T00:00:00.0000000Z\",\"period\":\"PT30M\"},{\"pv_estimate\":0,\"pv_estimate10\":0,\"pv_estimate90\":0,\"period_end\":\"2022-01-11T00:30:00.0000000Z\",\"period\":\"PT30M\"},{\"pv_estimate\":0,\"pv_estimate10\":0,\"pv_estimate90\":0,\"period_end\":\"2022-01-11T01:00:00.0000000Z\",\"period\":\"PT30M\"},{\"pv_estimate\":0,\"pv_estimate10\":0,\"pv_estimate90\":0,\"period_end\":\"2022-01-11T01:30:00.0000000Z\",\"period\":\"PT30M\"},{\"pv_estimate\":0,\"pv_estimate10\":0,\"pv_estimate90\":0,\"period_end\":\"2022-01-11T02:00:00.0000000Z\",\"period\":\"PT30M\"},{\"pv_estimate\":0,\"pv_estimate10\":0,\"pv_estimate90\":0,\"period_end\":\"2022-01-11T02:30:00.0000000Z\",\"period\":\"PT30M\"},{\"pv_estimate\":0,\"pv_estimate10\":0,\"pv_estimate90\":0,\"period_end\":\"2022-01-11T03:00:00.0000000Z\",\"period\":\"PT30M\"},{\"pv_estimate\":0,\"pv_estimate10\":0,\"pv_estimate90\":0,\"period_end\":\"2022-01-11T03:30:00.0000000Z\",\"period\":\"PT30M\"},{\"pv_estimate\":0,\"pv_estimate10\":0,\"pv_estimate90\":0,\"period_end\":\"2022-01-11T04:00:00.0000000Z\",\"period\":\"PT30M\"},{\"pv_estimate\":0,\"pv_estimate10\":0,\"pv_estimate90\":0,\"period_end\":\"2022-01-11T04:30:00.0000000Z\",\"period\":\"PT30M\"},{\"pv_estimate\":0,\"pv_estimate10\":0,\"pv_estimate90\":0,\"period_end\":\"2022-01-11T05:00:00.0000000Z\",\"period\":\"PT30M\"},{\"pv_estimate\":0,\"pv_estimate10\":0,\"pv_estimate90\":0,\"period_end\":\"2022-01-11T05:30:00.0000000Z\",\"period\":\"PT30M\"},{\"pv_estimate\":0,\"pv_estimate10\":0,\"pv_estimate90\":0,\"period_end\":\"2022-01-11T06:00:00.0000000Z\",\"period\":\"PT30M\"},{\"pv_estimate\":0,\"pv_estimate10\":0,\"pv_estimate90\":0,\"period_end\":\"2022-01-11T06:30:00.0000000Z\",\"period\":\"PT30M\"},{\"pv_estimate\":0,\"pv_estimate10\":0,\"pv_estimate90\":0,\"period_end\":\"2022-01-11T07:00:00.0000000Z\",\"period\":\"PT30M\"},{\"pv_estimate\":0.0307,\"pv_estimate10\":0.0105,\"pv_estimate90\":0.0343,\"period_end\":\"2022-01-11T07:30:00.0000000Z\",\"period\":\"PT30M\"},{\"pv_estimate\":0.1078,\"pv_estimate10\":0.0363,\"pv_estimate90\":0.11319000000000001,\"period_end\":\"2022-01-11T08:00:00.0000000Z\",\"period\":\"PT30M\"},{\"pv_estimate\":0.1931,\"pv_estimate10\":0.0724,\"pv_estimate90\":0.202755,\"period_end\":\"2022-01-11T08:30:00.0000000Z\",\"period\":\"PT30M\"},{\"pv_estimate\":0.4346,\"pv_estimate10\":0.1313,\"pv_estimate90\":0.45633,\"period_end\":\"2022-01-11T09:00:00.0000000Z\",\"period\":\"PT30M\"},{\"pv_estimate\":0.7591,\"pv_estimate10\":0.2131,\"pv_estimate90\":0.7970550000000001,\"period_end\":\"2022-01-11T09:30:00.0000000Z\",\"period\":\"PT30M\"},{\"pv_estimate\":1.2173,\"pv_estimate10\":0.3569,\"pv_estimate90\":1.278165,\"period_end\":\"2022-01-11T10:00:00.0000000Z\",\"period\":\"PT30M\"},{\"pv_estimate\":1.7758,\"pv_estimate10\":0.5072,\"pv_estimate90\":1.8779,\"period_end\":\"2022-01-11T10:30:00.0000000Z\",\"period\":\"PT30M\"},{\"pv_estimate\":2.3586,\"pv_estimate10\":0.6648,\"pv_estimate90\":2.7018,\"period_end\":\"2022-01-11T11:00:00.0000000Z\",\"period\":\"PT30M\"},{\"pv_estimate\":2.9814,\"pv_estimate10\":0.7946,\"pv_estimate90\":3.5883,\"period_end\":\"2022-01-11T11:30:00.0000000Z\",\"period\":\"PT30M\"},{\"pv_estimate\":3.4785,\"pv_estimate10\":0.8477,\"pv_estimate90\":4.3024,\"period_end\":\"2022-01-11T12:00:00.0000000Z\",\"period\":\"PT30M\"},{\"pv_estimate\":3.981,\"pv_estimate10\":0.8736,\"pv_estimate90\":5.1153,\"period_end\":\"2022-01-11T12:30:00.0000000Z\",\"period\":\"PT30M\"},{\"pv_estimate\":4.151,\"pv_estimate10\":0.7755,\"pv_estimate90\":5.6283,\"period_end\":\"2022-01-11T13:00:00.0000000Z\",\"period\":\"PT30M\"},{\"pv_estimate\":4.0949,\"pv_estimate10\":0.5964,\"pv_estimate90\":5.8182,\"period_end\":\"2022-01-11T13:30:00.0000000Z\",\"period\":\"PT30M\"},{\"pv_estimate\":3.5391,\"pv_estimate10\":0.4563,\"pv_estimate90\":5.4666,\"period_end\":\"2022-01-11T14:00:00.0000000Z\",\"period\":\"PT30M\"}]}";
    public int IntervalMinutes { get; set; } = 30;
    private TimeSpan QueryApiInterval { get; set; } = TimeSpan.FromHours(3);
    private DateTime DateTimeOfLastQuery { get; set; } = DateTime.MinValue;
    private string LastResultsString { get; set; }
    private List<ForecastDto> LastResultsList { get; set; }
    public SolCast(ILogger logger)
    {
      _logger = logger;
      //Attention: the Solcast is initialised with test data to avoid empty lists. This is a bodge and could be improved.
      LastResultsString = testData;
      LastResultsList = GetResultList(testData);
    }
    public async Task<List<ForecastDto>> GetSolarPowerForeCast()
    {
      //Do the REST query only every every somewhat interval - e.g. 3hrs. The power forecast won't change so frequently.
      if (System.DateTime.Now - DateTimeOfLastQuery > QueryApiInterval)
      {
        DateTimeOfLastQuery = System.DateTime.Now;
#if USE_TESTDATA
        LastResultsString = testData;
#else
        LastResultsString = await GetLastForeCast();
#endif
        LastResultsList.Clear();
        LastResultsList = GetResultList(LastResultsString);
      }

      return LastResultsList;
    }

    private async Task<string> GetLastForeCast()
    {
      var requestUrl = Constants.BaseUrl + Constants.GetRooftopSitesForecastUrl;
      requestUrl = string.Format(requestUrl, Constants.SiteId);
      var client = new HttpClient();
      client.DefaultRequestHeaders.Authorization = new AuthenticationHeaderValue("Bearer", Constants.ApiKey);
      client.DefaultRequestHeaders.Add("Accept", "application/json");
      var resultTask = client.GetStringAsync(requestUrl);
      return await resultTask;
    }

    private List<ForecastDto> GetResultList(string resultString)
    {
      var resultList = new List<ForecastDto>();
      try
      {
        var dataSet = JsonConvert.DeserializeObject<DataSet>(resultString);
        var dataTable = dataSet.Tables["forecasts"];
        foreach (DataRow row in dataTable.Rows)
        {
          var forecast = new ForecastDto()
          {
            Estimate = Convert.ToDouble(row["pv_estimate"]),
            Estimate10 = Convert.ToDouble(row["pv_estimate10"]),
            Estimate90 = Convert.ToDouble(row["pv_estimate90"]),
            PeriodEnd = Convert.ToDateTime(row["period_end"]),
          };
          var timespan = XmlConvert.ToTimeSpan(row["period"].ToString());
          forecast.PeriodStart = forecast.PeriodEnd - timespan;
          resultList.Add(forecast);
        }
      }
      catch (Exception e)
      {
        _logger.Error("Error in deserializing result from API call. " + e.Message + " result string: " + resultString);
        throw;
      }

      return resultList;
    }
  }
}
